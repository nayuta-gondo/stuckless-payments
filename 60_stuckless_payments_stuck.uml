@startuml
!pragma teoz true
title Stuckless Payments - Stuck
hide footbox
participant Alice
participant Bob
participant Carol
participant Dave

== Update ==

Alice -> Bob: update_add_htlc(h_A, h_D)

Alice <-> Bob: commit
& Bob -> Carol: update_add_htlc(h_A, h_D)

Bob <-> Carol: commit
& Carol -> Dave: update_add_htlc(h_A, h_D)

Carol <-> Dave: commit

Dave -> Carol: ACK
& Carol -> Bob: ACK
& Bob -> Alice: ACK

Alice -> Dave: send r_A

== Settlement ==

Dave -->x Alice: send r_D

@enduml
