@startuml
!pragma teoz true
title Payment Sequence - Early PoP
hide footbox
participant Alice
participant Bob
participant Carol
participant Dave

== Setup ==

Alice -> Alice: genarate y1,y2,y3
& Dave -> Dave: genarate y0

Alice -> Bob: y1
Alice -> Carol: y2
Alice -> Dave: y3

== Update ==

Alice -> Bob: update_add_ptlc

Alice <-> Bob: commit
& Bob -> Carol: update_add_ptlc

Bob <-> Carol: commit
& Carol -> Dave: update_add_ptlc

Carol <-> Dave: commit

Dave -> Carol: ACK
& Carol -> Bob: ACK
& Bob -> Alice: ACK

Alice -> Dave: y1+y2+y3

== Settlement ==

Dave --> Alice: y0

Dave -> Carol: y0+y1+y2
& Carol -> Bob: y0+y1
& Bob -> Alice: y0

@enduml
